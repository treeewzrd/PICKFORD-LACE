{"ast":null,"code":"import React,{useEffect}from'react';import{useStoreContext}from'../../utils/GlobalState';import{TOGGLE_CART,ADD_MULTIPLE_TO_CART}from'../../utils/actions';import{idbPromise}from'../../utils/helpers';import CartItem from'../CartItem';import Auth from'../../utils/auth';import{useNavigate}from'react-router-dom';import'./style.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Cart=()=>{const[state,dispatch]=useStoreContext();const navigate=useNavigate();useEffect(()=>{async function getCart(){const cart=await idbPromise('cart','get');dispatch({type:ADD_MULTIPLE_TO_CART,products:[...cart]});}if(!state.cart.length){getCart();}},[state.cart.length,dispatch]);function toggleCart(){dispatch({type:TOGGLE_CART});}function calculateTotal(){let sum=0;state.cart.forEach(item=>{sum+=item.price*item.purchaseQuantity;});return sum.toFixed(2);}function submitCheckout(){navigate('/success');}if(!state.cartOpen){return/*#__PURE__*/_jsx(\"div\",{className:\"cart-closed\",onClick:toggleCart,children:/*#__PURE__*/_jsx(\"span\",{role:\"img\",\"aria-label\":\"trash\",children:\"\\uD83D\\uDED2\"})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"cart\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"close\",onClick:toggleCart,children:\"[close]\"}),/*#__PURE__*/_jsx(\"h2\",{children:\"Shopping Cart\"}),state.cart.length?/*#__PURE__*/_jsxs(\"div\",{children:[state.cart.map(item=>/*#__PURE__*/_jsx(CartItem,{item:item},item._id)),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-row space-between\",children:[/*#__PURE__*/_jsxs(\"strong\",{children:[\"Total: $\",calculateTotal()]}),Auth.loggedIn()?/*#__PURE__*/_jsx(\"button\",{onClick:submitCheckout,children:\"Checkout\"}):/*#__PURE__*/_jsx(\"span\",{children:\"(log in to check out)\"})]})]}):/*#__PURE__*/_jsxs(\"h3\",{children:[/*#__PURE__*/_jsx(\"span\",{role:\"img\",\"aria-label\":\"shocked\",children:\"\\uD83D\\uDE31\"}),\"You haven't added anything to your cart yet!\"]})]});};export default Cart;","map":{"version":3,"names":["React","useEffect","useStoreContext","TOGGLE_CART","ADD_MULTIPLE_TO_CART","idbPromise","CartItem","Auth","useNavigate","jsx","_jsx","jsxs","_jsxs","Cart","state","dispatch","navigate","getCart","cart","type","products","length","toggleCart","calculateTotal","sum","forEach","item","price","purchaseQuantity","toFixed","submitCheckout","cartOpen","className","onClick","children","role","map","_id","loggedIn"],"sources":["C:/Bootcamp/mern-graphql-ecommerce/client/src/components/Cart/index.js"],"sourcesContent":["import React, { useEffect } from 'react';\r\nimport { useStoreContext } from '../../utils/GlobalState';\r\nimport { TOGGLE_CART, ADD_MULTIPLE_TO_CART } from '../../utils/actions';\r\nimport { idbPromise } from '../../utils/helpers';\r\nimport CartItem from '../CartItem';\r\nimport Auth from '../../utils/auth';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport './style.css';\r\n\r\nconst Cart = () => {\r\n  const [state, dispatch] = useStoreContext();\r\n  const navigate = useNavigate();\r\n\r\n  useEffect(() => {\r\n    async function getCart() {\r\n      const cart = await idbPromise('cart', 'get');\r\n      dispatch({ type: ADD_MULTIPLE_TO_CART, products: [...cart] });\r\n    }\r\n\r\n    if (!state.cart.length) {\r\n      getCart();\r\n    }\r\n  }, [state.cart.length, dispatch]);\r\n\r\n  function toggleCart() {\r\n    dispatch({ type: TOGGLE_CART });\r\n  }\r\n\r\n  function calculateTotal() {\r\n    let sum = 0;\r\n    state.cart.forEach((item) => {\r\n      sum += item.price * item.purchaseQuantity;\r\n    });\r\n    return sum.toFixed(2);\r\n  }\r\n\r\n  function submitCheckout() {\r\n    navigate('/success');\r\n  }\r\n\r\n  if (!state.cartOpen) {\r\n    return (\r\n      <div className=\"cart-closed\" onClick={toggleCart}>\r\n        <span role=\"img\" aria-label=\"trash\">\r\n          ðŸ›’\r\n        </span>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"cart\">\r\n      <div className=\"close\" onClick={toggleCart}>\r\n        [close]\r\n      </div>\r\n      <h2>Shopping Cart</h2>\r\n      {state.cart.length ? (\r\n        <div>\r\n          {state.cart.map((item) => (\r\n            <CartItem key={item._id} item={item} />\r\n          ))}\r\n\r\n          <div className=\"flex-row space-between\">\r\n            <strong>Total: ${calculateTotal()}</strong>\r\n\r\n            {Auth.loggedIn() ? (\r\n              <button onClick={submitCheckout}>Checkout</button>\r\n            ) : (\r\n              <span>(log in to check out)</span>\r\n            )}\r\n          </div>\r\n        </div>\r\n      ) : (\r\n        <h3>\r\n          <span role=\"img\" aria-label=\"shocked\">\r\n            ðŸ˜±\r\n          </span>\r\n          You haven't added anything to your cart yet!\r\n        </h3>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Cart;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}