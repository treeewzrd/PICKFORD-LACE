{"ast":null,"code":"import React,{useEffect,useState}from'react';import{Link,useParams}from'react-router-dom';import{useQuery}from'@apollo/client';import{useStoreContext}from'../utils/GlobalState';import{REMOVE_FROM_CART,UPDATE_CART_QUANTITY,ADD_TO_CART,UPDATE_PRODUCTS}from'../utils/actions';import{QUERY_PRODUCTS}from'../utils/queries';import spinner from'../assets/spinner.gif';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function Detail(){const[state,dispatch]=useStoreContext();const{id}=useParams();const[currentProduct,setCurrentProduct]=useState({});const{loading,data}=useQuery(QUERY_PRODUCTS);const{products,cart}=state;useEffect(()=>{// already in global store\nif(products.length){setCurrentProduct(products.find(product=>product._id===id));}// retrieved from server\nelse if(data){dispatch({type:UPDATE_PRODUCTS,products:data.products});data.products.forEach(product=>{if(product._id===id){setCurrentProduct(product);}});}},[products,data,dispatch,id]);const addToCart=()=>{const itemInCart=cart.find(cartItem=>cartItem._id===id);if(itemInCart){dispatch({type:UPDATE_CART_QUANTITY,_id:id,purchaseQuantity:parseInt(itemInCart.purchaseQuantity)+1});}else{dispatch({type:ADD_TO_CART,product:{...currentProduct,purchaseQuantity:1}});}};const removeFromCart=()=>{dispatch({type:REMOVE_FROM_CART,_id:currentProduct._id});};return/*#__PURE__*/_jsxs(_Fragment,{children:[currentProduct&&cart?/*#__PURE__*/_jsxs(\"div\",{className:\"container my-1\",children:[/*#__PURE__*/_jsx(Link,{to:\"/\",children:\"\\u2190 Back to Products\"}),/*#__PURE__*/_jsx(\"h2\",{children:currentProduct.name}),/*#__PURE__*/_jsx(\"p\",{children:currentProduct.description}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Price:\"}),\"$\",currentProduct.price,' ',/*#__PURE__*/_jsx(\"button\",{onClick:addToCart,children:\"Add to Cart\"}),/*#__PURE__*/_jsx(\"button\",{disabled:!cart.find(p=>p._id===currentProduct._id),onClick:removeFromCart,children:\"Remove from Cart\"})]}),/*#__PURE__*/_jsx(\"img\",{src:`/images/${currentProduct.image}`,alt:currentProduct.name})]}):null,loading?/*#__PURE__*/_jsx(\"img\",{src:spinner,alt:\"loading\"}):null]});}export default Detail;","map":{"version":3,"names":["React","useEffect","useState","Link","useParams","useQuery","useStoreContext","REMOVE_FROM_CART","UPDATE_CART_QUANTITY","ADD_TO_CART","UPDATE_PRODUCTS","QUERY_PRODUCTS","spinner","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Detail","state","dispatch","id","currentProduct","setCurrentProduct","loading","data","products","cart","length","find","product","_id","type","forEach","addToCart","itemInCart","cartItem","purchaseQuantity","parseInt","removeFromCart","children","className","to","name","description","price","onClick","disabled","p","src","image","alt"],"sources":["C:/Bootcamp/mern-graphql-ecommerce/client/src/pages/Detail.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { Link, useParams } from 'react-router-dom';\r\nimport { useQuery } from '@apollo/client';\r\nimport { useStoreContext } from '../utils/GlobalState';\r\nimport {\r\n  REMOVE_FROM_CART,\r\n  UPDATE_CART_QUANTITY,\r\n  ADD_TO_CART,\r\n  UPDATE_PRODUCTS,\r\n} from '../utils/actions';\r\nimport { QUERY_PRODUCTS } from '../utils/queries';\r\nimport spinner from '../assets/spinner.gif';\r\n\r\nfunction Detail() {\r\n  const [state, dispatch] = useStoreContext();\r\n  const { id } = useParams();\r\n\r\n  const [currentProduct, setCurrentProduct] = useState({});\r\n\r\n  const { loading, data } = useQuery(QUERY_PRODUCTS);\r\n\r\n  const { products, cart } = state;\r\n\r\n  useEffect(() => {\r\n    // already in global store\r\n    if (products.length) {\r\n      setCurrentProduct(products.find((product) => product._id === id));\r\n    }\r\n    // retrieved from server\r\n    else if (data) {\r\n      dispatch({\r\n        type: UPDATE_PRODUCTS,\r\n        products: data.products,\r\n      });\r\n\r\n      data.products.forEach((product) => {\r\n        if (product._id === id) {\r\n          setCurrentProduct(product);\r\n        }\r\n      });\r\n    }\r\n  }, [products, data, dispatch, id]);\r\n\r\n  const addToCart = () => {\r\n    const itemInCart = cart.find((cartItem) => cartItem._id === id);\r\n    if (itemInCart) {\r\n      dispatch({\r\n        type: UPDATE_CART_QUANTITY,\r\n        _id: id,\r\n        purchaseQuantity: parseInt(itemInCart.purchaseQuantity) + 1,\r\n      });\r\n    } else {\r\n      dispatch({\r\n        type: ADD_TO_CART,\r\n        product: { ...currentProduct, purchaseQuantity: 1 },\r\n      });\r\n    }\r\n  };\r\n\r\n  const removeFromCart = () => {\r\n    dispatch({\r\n      type: REMOVE_FROM_CART,\r\n      _id: currentProduct._id,\r\n    });\r\n  };\r\n\r\n  return (\r\n    <>\r\n      {currentProduct && cart ? (\r\n        <div className=\"container my-1\">\r\n          <Link to=\"/\">‚Üê Back to Products</Link>\r\n\r\n          <h2>{currentProduct.name}</h2>\r\n\r\n          <p>{currentProduct.description}</p>\r\n\r\n          <p>\r\n            <strong>Price:</strong>${currentProduct.price}{' '}\r\n            <button onClick={addToCart}>Add to Cart</button>\r\n            <button\r\n              disabled={!cart.find((p) => p._id === currentProduct._id)}\r\n              onClick={removeFromCart}\r\n            >\r\n              Remove from Cart\r\n            </button>\r\n          </p>\r\n\r\n          <img\r\n            src={`/images/${currentProduct.image}`}\r\n            alt={currentProduct.name}\r\n          />\r\n        </div>\r\n      ) : null}\r\n      {loading ? <img src={spinner} alt=\"loading\" /> : null}\r\n    </>\r\n  );\r\n}\r\n\r\nexport default Detail;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}