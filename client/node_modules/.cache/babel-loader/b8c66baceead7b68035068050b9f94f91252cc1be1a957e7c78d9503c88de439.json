{"ast":null,"code":"var _jsxFileName = \"C:\\\\Bootcamp\\\\mern-graphql-ecommerce\\\\client\\\\src\\\\pages\\\\Checkout.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect } from 'react';\nimport { useMutation } from '@apollo/client';\nimport { loadStripe } from '@stripe/stripe-js';\nimport { CREATE_CHECKOUT_SESSION } from '../utils/mutations';\nimport { useStoreContext } from '../utils/GlobalState';\nimport { CLEAR_CART } from '../utils/actions';\nimport Auth from '../utils/auth';\nimport { Container, Row, Col, Card, Button } from 'react-bootstrap';\n\n// Load Stripe\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst stripePromise = loadStripe('pk_test_TYRGmROdQvnmh4qeicFf0w8q00lClIxyE4');\nconst Checkout = () => {\n  _s();\n  const [state, dispatch] = useStoreContext();\n  const [getCheckout, {\n    data\n  }] = useMutation(CREATE_CHECKOUT_SESSION);\n  useEffect(() => {\n    if (data) {\n      stripePromise.then(res => {\n        res.redirectToCheckout({\n          sessionId: data.createCheckoutSession.session\n        });\n      });\n      dispatch({\n        type: CLEAR_CART\n      });\n    }\n  }, [data, dispatch]);\n  function calculateTotal() {\n    let sum = 0;\n    state.cart.forEach(item => {\n      sum += item.price * item.purchaseQuantity;\n    });\n    return sum.toFixed(2);\n  }\n  function submitCheckout() {\n    const productIds = [];\n    state.cart.forEach(item => {\n      for (let i = 0; i < item.purchaseQuantity; i++) {\n        productIds.push(item._id);\n      }\n    });\n    getCheckout({\n      variables: {\n        products: productIds\n      }\n    });\n  }\n  if (!state.cart.length) {\n    return /*#__PURE__*/_jsxDEV(Container, {\n      className: \"my-5\",\n      children: /*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"Your cart is empty!\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 51,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(Container, {\n    className: \"my-5\",\n    children: /*#__PURE__*/_jsxDEV(Row, {\n      children: [/*#__PURE__*/_jsxDEV(Col, {\n        md: 8,\n        children: /*#__PURE__*/_jsxDEV(Card, {\n          children: [/*#__PURE__*/_jsxDEV(Card.Header, {\n            children: /*#__PURE__*/_jsxDEV(\"h2\", {\n              children: \"Checkout Summary\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 62,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 61,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Card.Body, {\n            children: [state.cart.map(item => /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"d-flex justify-content-between mb-3\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: item.name\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 68,\n                  columnNumber: 21\n                }, this), \" (\", item.purchaseQuantity, \")\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 67,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: [\"$\", (item.price * item.purchaseQuantity).toFixed(2)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 70,\n                columnNumber: 19\n              }, this)]\n            }, item._id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 66,\n              columnNumber: 17\n            }, this)), /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 73,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"d-flex justify-content-between\",\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Total:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 75,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"strong\", {\n                children: [\"$\", calculateTotal()]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 76,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 74,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 64,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 60,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 59,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Col, {\n        md: 4,\n        children: /*#__PURE__*/_jsxDEV(Card, {\n          children: /*#__PURE__*/_jsxDEV(Card.Body, {\n            children: Auth.loggedIn() ? /*#__PURE__*/_jsxDEV(Button, {\n              variant: \"primary\",\n              className: \"w-100\",\n              onClick: submitCheckout,\n              children: \"Proceed to Payment\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 85,\n              columnNumber: 17\n            }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [\"Please \", /*#__PURE__*/_jsxDEV(\"a\", {\n                href: \"/login\",\n                children: \"log in\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 93,\n                columnNumber: 27\n              }, this), \" to complete your purchase.\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 93,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 83,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 82,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 57,\n    columnNumber: 5\n  }, this);\n};\n_s(Checkout, \"AxugYgqPIzb05rLxciaZCPN/N/4=\", false, function () {\n  return [useStoreContext, useMutation];\n});\n_c = Checkout;\nexport default Checkout;\nvar _c;\n$RefreshReg$(_c, \"Checkout\");","map":{"version":3,"names":["React","useEffect","useMutation","loadStripe","CREATE_CHECKOUT_SESSION","useStoreContext","CLEAR_CART","Auth","Container","Row","Col","Card","Button","jsxDEV","_jsxDEV","stripePromise","Checkout","_s","state","dispatch","getCheckout","data","then","res","redirectToCheckout","sessionId","createCheckoutSession","session","type","calculateTotal","sum","cart","forEach","item","price","purchaseQuantity","toFixed","submitCheckout","productIds","i","push","_id","variables","products","length","className","children","fileName","_jsxFileName","lineNumber","columnNumber","md","Header","Body","map","name","loggedIn","variant","onClick","href","_c","$RefreshReg$"],"sources":["C:/Bootcamp/mern-graphql-ecommerce/client/src/pages/Checkout.js"],"sourcesContent":["import React, { useEffect } from 'react';\r\nimport { useMutation } from '@apollo/client';\r\nimport { loadStripe } from '@stripe/stripe-js';\r\nimport { CREATE_CHECKOUT_SESSION } from '../utils/mutations';\r\nimport { useStoreContext } from '../utils/GlobalState';\r\nimport { CLEAR_CART } from '../utils/actions';\r\nimport Auth from '../utils/auth';\r\nimport { Container, Row, Col, Card, Button } from 'react-bootstrap';\r\n\r\n// Load Stripe\r\nconst stripePromise = loadStripe('pk_test_TYRGmROdQvnmh4qeicFf0w8q00lClIxyE4');\r\n\r\nconst Checkout = () => {\r\n  const [state, dispatch] = useStoreContext();\r\n  const [getCheckout, { data }] = useMutation(CREATE_CHECKOUT_SESSION);\r\n  \r\n  useEffect(() => {\r\n    if (data) {\r\n      stripePromise.then((res) => {\r\n        res.redirectToCheckout({ sessionId: data.createCheckoutSession.session });\r\n      });\r\n      dispatch({ type: CLEAR_CART });\r\n    }\r\n  }, [data, dispatch]);\r\n  \r\n  function calculateTotal() {\r\n    let sum = 0;\r\n    state.cart.forEach((item) => {\r\n      sum += item.price * item.purchaseQuantity;\r\n    });\r\n    return sum.toFixed(2);\r\n  }\r\n  \r\n  function submitCheckout() {\r\n    const productIds = [];\r\n    \r\n    state.cart.forEach((item) => {\r\n      for (let i = 0; i < item.purchaseQuantity; i++) {\r\n        productIds.push(item._id);\r\n      }\r\n    });\r\n    \r\n    getCheckout({\r\n      variables: { products: productIds },\r\n    });\r\n  }\r\n  \r\n  if (!state.cart.length) {\r\n    return (\r\n      <Container className=\"my-5\">\r\n        <h2>Your cart is empty!</h2>\r\n      </Container>\r\n    );\r\n  }\r\n  \r\n  return (\r\n    <Container className=\"my-5\">\r\n      <Row>\r\n        <Col md={8}>\r\n          <Card>\r\n            <Card.Header>\r\n              <h2>Checkout Summary</h2>\r\n            </Card.Header>\r\n            <Card.Body>\r\n              {state.cart.map((item) => (\r\n                <div key={item._id} className=\"d-flex justify-content-between mb-3\">\r\n                  <div>\r\n                    <strong>{item.name}</strong> ({item.purchaseQuantity})\r\n                  </div>\r\n                  <div>${(item.price * item.purchaseQuantity).toFixed(2)}</div>\r\n                </div>\r\n              ))}\r\n              <hr />\r\n              <div className=\"d-flex justify-content-between\">\r\n                <strong>Total:</strong>\r\n                <strong>${calculateTotal()}</strong>\r\n              </div>\r\n            </Card.Body>\r\n          </Card>\r\n        </Col>\r\n        <Col md={4}>\r\n          <Card>\r\n            <Card.Body>\r\n              {Auth.loggedIn() ? (\r\n                <Button \r\n                  variant=\"primary\" \r\n                  className=\"w-100\"\r\n                  onClick={submitCheckout}\r\n                >\r\n                  Proceed to Payment\r\n                </Button>\r\n              ) : (\r\n                <p>Please <a href=\"/login\">log in</a> to complete your purchase.</p>\r\n              )}\r\n            </Card.Body>\r\n          </Card>\r\n        </Col>\r\n      </Row>\r\n    </Container>\r\n  );\r\n};\r\n\r\nexport default Checkout;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}